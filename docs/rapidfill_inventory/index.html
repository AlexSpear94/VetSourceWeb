<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Rapidfill Inventory</title>
<style>
.theme-light{
	--color-primary: #FFFFFF;
	--color-secondary: #000000;
	--font-color: #000000;
	--button-background: #EFEFEF;
	--button-disabled-background: #A0A0A0;
	--button-disabled-font: #606060;
	--faded-border: #303030;
	--color-edge: #808080;
	--overlay-background: #FFFFFFE0;
}
.theme-dark{
	--color-primary: #000000;
	--color-secondary: #FFFFFF;
	--font-color: #FFFFFF;
	--button-background: #202020;
	--button-disabled-background: #606060;
	--button-disabled-font: #A0A0A0;
	--faded-border: #c0c0c0;
	--color-edge: #808080;
	--overlay-background: #000000E0;
}
body{
	background-color: var(--color-primary);
	color: var(--font-color);
	text-align: center;
}
div{
	margin: 0 auto;
}
div.divHeaderButtons{
	margin: 0 30% 0 70%;
}
button{
	background-color: var(--button-background);
	border-color: var(--color-secondary);
	color: var(--font-color);
	font-size: large;
	border-width: .05em;
	margin: .18em;
	padding: .18em;
	cursor: pointer;
}
button.buttonMain{
	font-size: xx-large;
	margin: .24em;
	padding: .24em;
}
button:disabled,
button[disabled]{
	background-color: var(--button-disabled-background);
	border-color: var(--faded-border);
	color: var(--button-disabled-font);
	cursor: default;
}
h1{
	font-size: 300%;
}
input{
	background-color: var(--color-primary);
	border-color: var(--color-secondary);
	border-width: .05em;
	color: var(--font-color);
	text-align: center;
	max-width: 3.5em;
	cursor: text;
}
input.large{
	font-size: 150%;
}
input.wide{
	font-size: 150%;
	max-width: 18em;
}
input.checkbox{
	width: 2em;
	height: 2em;
	-webkit-appearance: none;
	background-color: var(--color-primary);
	border: .1em solid var(--faded-border);
	padding: .6em;
	border-radius: .2em;
	display: inline-block;
	position: relative;
	cursor: pointer;
}
input.checkbox:checked:after {
	content: '\2714';
	font-size: 1.5em;
	position: absolute;
	top: -.15em;
	left: .2em;
	color: var(--font-color);
}
input.checkbox:disabled {
	background-color: var(--button-background);
	cursor: default;
}
td{
	padding: .6em;
	border-color: var(--color-edge);
	border-width: .06em;
	border-style: solid;
	max-width: 18em;
	background-color: var(--color-primary);
}
th{
	padding: .6em;
	border-color: var(--color-edge);
	border-width: .06em;
	border-style: solid;
	max-width: 18em;
	background-color: var(--color-primary);
	position: sticky;
	top: 0;
	z-index: 1;
}
td.large{
	font-size: 150%;
	border-width: .04em;
}
th.thin{
	max-width: 5em;
}
table{
	position: relative;
	display: inline-block;
	border-collapse: separate;
	border-spacing: 0;
}
.divTable{
	max-height: 40em;
	overflow-y: scroll;
	width: max-content;
}
#divOverlay{
	position: fixed;
	display: none;
	width: 100%;
	height: 100%;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background-color: var(--overlay-background);
	z-index: 2;
	cursor: default;
}
.fixedBottomRight{
	position: fixed;
	right: 0%;
	bottom: 0%;
}
.fixedBottomLeft{
	position: fixed;
	left: 0%;
	bottom: 0%;
}
.overlayText{
	margin: 0;
	position: absolute;
	top: 50%;
	left: 50%;
	-ms-transform: translate(-50%, -50%);
	transform: translate(-50%, -50%);
}
.overlayButton{
	margin: 0;
	position: absolute;
	top: 60%;
	left: 50%;
	-ms-transform: translate(-50%, -40%);
	transform: translate(-50%, -40%);
	background-color: var(--color-primary);
}
@media print {
body,input{
	background-color: white;
	color: black;
	border-width: 0em;
	font-size: 10pt;
}
td,th{
	padding: .1em;
	max-width: 15em;
}
input.wide,input.large{
	max-width: 4em;
}
h1,h2,td.large,input.wide,input.large{
	font-size: 10pt;
}
div.divTable, table{
	display: block;
	max-height: unset;
	overflow-y: auto;
}
tr{
	break-inside: avoid;
}
.noPrint,button{
	display: none !important;
}
input.checkbox{
	background-color: #FFFFFF;
	border-width: 0em;
}
input.checkbox:checked:after {
	color: #000000;
}
input.checkbox:disabled {
	background-color: #FFFFFF;
}
}
</style>
<link rel="icon" type="image/png" sizes="32x32" href="/vetsource_web/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/vetsource_web/images/favicon-16x16.png">
</head>
<body onload="initPage()">
<script>
function initPage(){
	_googleSheetURL = 'https://script.google.com/a/macros/vetsource.com/s/AKfycbxlAB8Eq9Coi0_-CrFDrh42_bl8380pXzAZyXQyCZI4dxr8bot0KdsfpwFgQkOeYkTk-g/exec';

	currentPage = 0;
	isPageLoaded = false;
	tableData = new Array();
	editingProductID = -1;
	editingProductIndex = 0;
	tableInputs = new Array();
	isWaitingOnNetwork = false;
	hasUnsavedChanges = false;

	currentHash = "";

	refreshTime = Date.now();

	loadTheme();

	previousWebRequest = {"url":"", "data": "", "loadCallback": 0};

	elementSubTitle = document.getElementById("subTitle");
	elementSubTitleTextNode = elementSubTitle.childNodes[0];

	elementDivOverlay = document.getElementById("divOverlay");
	elementOverlayTextNode = document.getElementById("overlayText").childNodes[0];
	elementOverlayButton = document.getElementById("buttonOverlay");

	elementRefreshedLabelTextNode = document.createTextNode("");
	document.getElementById("refreshedLabel").appendChild(elementRefreshedLabelTextNode);

	window.addEventListener("hashchange", onHashChange, false);
	loadDataFromSheet();
}

function onDataLoaded(){
	var disableBins = true;
	var disablePreviousRound = true;
	var disableReceiving = true;
	document.getElementById('divBottomLeft').style.display = 'none';
	for (var i = 0; i < tableData.length; i++){
		if (tableData[i].BINS_NEEDED > 0){
			disableBins = false;
			break;
		}
	}
	for (var i = 0; i < tableData.length; i++){
		var round = tableData[i].PREVIOUS_ROUND;
		switch (typeof round){
		case 'number':
			if (round > 0) disablePreviousRound = false;
			break;
		case 'string':
			if (parseInt(round) > 0 || round.indexOf(',') > -1) disablePreviousRound = false;
			break;
		}
		if (!disablePreviousRound) break;
	}
	for (var i = 0; i < tableData.length; i++){
		if (tableData[i].BINS_NEEDED_FROM_RECEIVING || tableData[i].TOOK_LAST_CASI_BIN || tableData[i].OOS_SHARE_WITH_CASI){
			disableReceiving = false;
			break;
		}
	}
	var button = document.getElementById("buttonMainBin");
	if (button.disabled != disableBins){
		button.disabled = disableBins;
		if (disableBins) button.title = "Bin Picking: No bins neccessary."
		else button.title = "Pick depleted bins for rapidfill."
	}
	button = document.getElementById("buttonMainPreviousRound");
	if (button.disabled != disablePreviousRound){
		button.disabled = disablePreviousRound;
		if (disablePreviousRound) button.title = "No round exists yet for today."
		else button.title = "View the quantities of today's rounds."
	}
	button = document.getElementById("buttonMainReceiving");
	if (button.disabled != disableReceiving){
		button.disabled = disableReceiving;
		if (disableReceiving) button.title = "Receiving: No refills requested from Rapidfill."
		else button.title = "Receiving: Manage refills and bins in rapidfill and on the Casi line."
	}
	loadPage(currentPage);

	updateRefreshedLabel();
}

function unloadCurrentPage(){
	switch (currentPage){
		case 0:
			document.getElementById("divMainMenuButtons").style.display = "none";
			break;
		case 1:
			document.getElementById("divPickTable").style.display = "none";
			document.getElementById("divHeaderButtons").style.display = "none";
			document.getElementById("divFooterButtons").style.display = "none";
			break;
		case 2:
			document.getElementById("divBinTable").style.display = "none";
			document.getElementById("divHeaderButtons").style.display = "none";
			document.getElementById("divFooterButtons").style.display = "none";
			document.getElementById("buttonSetZero").style.display = "none";
			document.getElementById("buttonSetBins").style.display = "none";
			break;
		case 3:
			document.getElementById("divInventoryTable").style.display = "none";
			document.getElementById("divHeaderButtons").style.display = "none";
			break;
		case 4:
			document.getElementById("divCycleCountTable").style.display = "none";
			document.getElementById("divHeaderButtons").style.display = "none";
			document.getElementById("divFooterButtons").style.display = "none";
			break;
		case 5:
			document.getElementById("divEditProductsTable").style.display = "none";
			document.getElementById("divHeaderButtons").style.display = "none";
			document.getElementById("buttonAddProduct").style.display = "none";
			break;
		case 6:
			document.getElementById("divEditSingleProduct").style.display = "none";
			document.getElementById("divHeaderButtons").style.display = "none";
			document.getElementById("divFooterButtons").style.display = "none";
			document.getElementById("buttonCancel").style.display = "none";
			break;
		case 7:
			document.getElementById("divPreviousRound").style.display = "none";
			document.getElementById("divHeaderButtons").style.display = "none";
			break;
		case 8:
			document.getElementById("divAddProduct").style.display = "none";
			document.getElementById("divHeaderButtons").style.display = "none";
			document.getElementById("divFooterButtons").style.display = "none";
			document.getElementById("buttonCancel").style.display = "none";
			break;
		case 9:
			document.getElementById("divReceivingTable").style.display = "none";
			document.getElementById("divHeaderButtons").style.display = "none";
			document.getElementById("divFooterButtons").style.display = "none";
			document.getElementById("buttonSetZero").style.display = "none";
			document.getElementById("buttonSetBins").style.display = "none";
	}
	isPageLoaded = false;
}

function loadPage(page){
	if (page > 0 && currentPage != 6 && currentPage != 8){
		if (!refreshCheck()) return;
	}
	setOverlay(false,null,false);
	hasUnsavedChanges = false;
	if (isPageLoaded) unloadCurrentPage();
	currentPage = page;
	switch (currentPage){
	case 0://Main Menu
		currentHash = "";
		if (window.location.hash != currentHash) window.location.hash = currentHash;
		setSubtitle(false, null);
		document.getElementById("divMainMenuButtons").style.display = "initial";
		break;
	case 1://New Round
		currentHash = "#inputround";
		if (window.location.hash != currentHash) window.location.hash = currentHash;
		buildPickTable();
		setSubtitle(true, "Input Round");
		document.getElementById("divPickTable").style.display = "block";
		document.getElementById("divHeaderButtons").style.display = "block";
		document.getElementById("divFooterButtons").style.display = "block";
		break;
	case 2://Bin Picking
		currentHash = "#binpicking";
		if (window.location.hash != currentHash) window.location.hash = currentHash;
		buildBinTable();
		setSubtitle(true, "Bin Picking");
		document.getElementById("divBinTable").style.display = "block";
		document.getElementById("divHeaderButtons").style.display = "block";
		document.getElementById("divFooterButtons").style.display = "block";
		document.getElementById("buttonSetZero").style.display = "inline";
		document.getElementById("buttonSetBins").style.display = "inline";
		break;
	case 3://View Inventory
		currentHash = "#viewinventory";
		if (window.location.hash != currentHash) window.location.hash = currentHash;
		buildInventoryTable();
		setSubtitle(true, "Viewing Inventory");
		document.getElementById("divInventoryTable").style.display = "block";
		document.getElementById("divHeaderButtons").style.display = "block";
		break;
	case 4://Update Counts
		currentHash = "#updatecounts";
		if (window.location.hash != currentHash) window.location.hash = currentHash;
		buildCycleCountTable();
		setSubtitle(true, "Update Counts");
		document.getElementById("divCycleCountTable").style.display = "block";
		document.getElementById("divHeaderButtons").style.display = "block";
		document.getElementById("divFooterButtons").style.display = "block";
		break;
	case 5://Edit Products
		currentHash = "#editproducts";
		if (window.location.hash != currentHash) window.location.hash = currentHash;
		buildEditProductsTable();
		setSubtitle(true, "Editing Products");
		document.getElementById("divEditProductsTable").style.display = "block";
		document.getElementById("divHeaderButtons").style.display = "block";
		document.getElementById("buttonAddProduct").style.display = "inline";
		break;
	case 6://Edit Single Product
		currentHash = "#editproduct";
		if (window.location.hash != currentHash) window.location.hash = currentHash;
		buildEditSingleProductTable();
		setSubtitle(true, "Editing a Product");
		document.getElementById("divEditSingleProduct").style.display = "block";
		document.getElementById("divHeaderButtons").style.display = "block";
		document.getElementById("divFooterButtons").style.display = "block";
		document.getElementById("buttonCancel").style.display = "inline";
		break;
	case 7://View Previous Round
		currentHash = "#viewpreviousround";
		if (window.location.hash != currentHash) window.location.hash = currentHash;
		buildPreviousRoundTable();
		setSubtitle(true, "Viewing Today's Rounds");
		document.getElementById("divPreviousRound").style.display = "block";
		document.getElementById("divHeaderButtons").style.display = "block";
		break;
	case 8://Add New Product
		currentHash = "#addproduct";
		if (window.location.hash != currentHash) window.location.hash = currentHash;
		buildAddProductTable();
		setSubtitle(true, "Adding a new Product");
		document.getElementById("divAddProduct").style.display = "block";
		document.getElementById("divHeaderButtons").style.display = "block";
		document.getElementById("divFooterButtons").style.display = "block";
		document.getElementById("buttonCancel").style.display = "inline";
		break;
	case 9://Receiving Refills
		currentHash = "#receivingrefills";
		if (window.location.hash != currentHash) window.location.hash = currentHash;
		buildReceivingTable();
		setSubtitle(true, "Receiving Refills");
		document.getElementById("divReceivingTable").style.display = "block";
		document.getElementById("divHeaderButtons").style.display = "block";
		document.getElementById("divFooterButtons").style.display = "block";
		document.getElementById("buttonSetZero").style.display = "inline";
		document.getElementById("buttonSetBins").style.display = "inline";
		break;
	}
	isPageLoaded = true;
}

//Callback function to detect when the browser navigation buttons have been pressed, and loads page accordingly.
function onHashChange(){
	if (window.location.hash != currentHash && !isWaitingOnNetwork) {
		switch (window.location.hash){
		case "":
		case "#":
			loadPage(0);
			break;
		case "#inputround":
			loadPage(1);
			break;
		case "#binpicking":
			loadPage(2);
			break;
		case "#viewinventory":
			loadPage(3);
			break;
		case "#updatecounts":
			loadPage(4);
			break;
		case "#editproducts":
			loadPage(5);
			break;
		case "#editproduct":
			loadPage(6);
			break;
		case "#viewpreviousround":
			loadPage(7);
			break;
		case "#addproduct":
			loadPage(8);
			break;
		}
	}
}

function setSubtitle(visible, text){
	if (visible){
		elementSubTitle.style.display = "block";
		elementSubTitleTextNode.nodeValue = text;
		return;
	}
	elementSubTitle.style.display = "none";
}

function setOverlay(visible, text, button){
	if (visible){
		elementDivOverlay.style.display = "block";
		elementOverlayTextNode.nodeValue = text;
		if (button){
			elementOverlayButton.style.display = "block";
		}
		else{
			elementOverlayButton.style.display = "none";
		}
		return;
	}
	elementDivOverlay.style.display = "none";
}

//Checks if a refresh has been done recently. If not, ask the user if they want to proceed.
function refreshCheck(){
	if ((Date.now() - refreshTime) < 1000*60*30) return true;//30 Minutes
	return confirm("A refresh hasn't been done recently. Proceed?");
}

function updateRefreshedLabel(){
	var d = new Date();
	refreshTime = d.getTime();
	var hours = d.getHours();
	var ampm = hours >= 12 ? 'PM' : 'AM';
	if (hours > 12) hours -= 12;
	if (hours == 0) hours = 12;
	var minutes = d.getMinutes();
	if (minutes < 10) minutes = "0" + minutes;
	elementRefreshedLabelTextNode.nodeValue = "Refreshed at " + hours + ":" + minutes + " " + ampm + ". If changes are made at another station, refresh the page.";
}

function onSubmitButtonClick(){
	if (isWaitingOnNetwork) return;
	switch (currentPage){
	case 1://New round
		var outData = new Array();
		for (var i = 0; i < tableData.length; i++){
			try{
				var num = parseInt(tableInputs[i].value);
				if (!(num > 0)) continue;//Not to account for NaN
				outData.push({"ID":tableData[i].ID, "QTY":num});
			}
			catch (e){}
		}
		if (outData.length <= 0){
			alert("Nothing to submit!");
			return;
		}
		submitRoundToSheet(outData);
		break;
	case 2://Bin Picking
		var outData = new Array();
		for (var i = 0; i < tableInputs.length / 4; i++){
			try{
				var num = parseInt(tableInputs[i*4].value);
				if (isNaN(num) || num < 0) num = 0;
				var numPartial = parseInt(tableInputs[i*4+1].value);
				if (isNaN(numPartial) || numPartial < 0 || num == 0) numPartial = 0;
				var requestBins = tableInputs[i*4+2].checked == true;
				var tookLastBin = tableInputs[i*4+3].checked == true;
				if (tableInputs[i*4+2].checked != tableInputs[i*4+2].initialValue || tableInputs[i*4+3].checked != tableInputs[i*4+3].initialValue || num > 0)
					outData.push({"ID":tableInputs[i*4].productID, "BIN_QTY":num, "PARTIAL_QTY":numPartial, "BINS_NEEDED_FROM_RECEIVING":requestBins, "TOOK_LAST_CASI_BIN":tookLastBin});
			}
			catch (e){}
		}
		if (outData.length <= 0){
			alert("Nothing to submit!");
			return;
		}
		submitBinReplenishmentToSheet(outData);
		break;
	case 4://Update Counts
		var outData = new Array();
		for (var i = 0; i < tableData.length; i++){
			try{
				var num = parseInt(tableInputs[i*3].value);
				if (isNaN(num)) num = tableData[i].IN_RAPIDFILL;
				var requestBins = tableInputs[i*3+1].checked == true;
				var tookLastBin = tableInputs[i*3+2].checked == true;
				if (tableInputs[i*3+1].checked != tableInputs[i*3+1].initialValue || tableInputs[i*3+2].checked != tableInputs[i*3+2].initialValue || num != tableData[i].IN_RAPIDFILL)
					outData.push({"ID":tableData[i].ID, "QTY":num, "BINS_NEEDED_FROM_RECEIVING":requestBins, "TOOK_LAST_CASI_BIN":tookLastBin});
			}
			catch (e){}
		}
		if (outData.length <= 0){
			alert("Nothing to submit!");
			return;
		}
		submitCycleCountToSheet(outData);
		break;
	case 6://Edit Single Product
		if (tableData[editingProductIndex].SKU == tableInputs[0].value &&
			tableData[editingProductIndex].PRODUCT_NAME == tableInputs[1].value &&
			tableData[editingProductIndex].LOCATION == tableInputs[2].value &&
			tableData[editingProductIndex].BIN_QTY == tableInputs[3].value &&
			tableData[editingProductIndex].PAR_LEVEL == tableInputs[4].value){
			alert("No changes to submit!");
			return;
		}
		try{
			var outData = new Array();
			var numBinQty = parseInt(tableInputs[3].value);
			if (!(numBinQty > 0)){//Not to account for NaN
				alert("Invalid Bin Qty!");
				return;
			}
			var numParLevel = parseInt(tableInputs[4].value);
			if (!(numParLevel >= 0)){//Not to account for NaN
				alert("Invalid Par Level!");
				return;
			}
			outData.push({"ID":editingProductID, "SKU":tableInputs[0].value, "PRODUCT_NAME":tableInputs[1].value, "LOCATION":tableInputs[2].value, "BIN_QTY":numBinQty, "PAR_LEVEL":numParLevel});
			submitEditProductToSheet(outData);
		}
		catch (e){}
		break;
	case 8://Add New Product
		try{
			if (tableInputs[0].value == ""){
				alert("Enter a product SKU!");
				return;
			}
			if (tableInputs[1].value == ""){
				alert("Enter a product name!");
				return;
			}
			if (tableInputs[2].value == ""){
				alert("Enter a location!");
				return;
			}
			var numBinQty = parseInt(tableInputs[3].value);
			if (!(numBinQty > 0)){
				alert("Quantity per bin must be greater than 0!");
				return;
			}
			var numParLevel = parseInt(tableInputs[4].value);
			if (!(numParLevel >= 0)){
				alert("Invalid Par Level!");
				return;
			}
			var numInitialCount = parseInt(tableInputs[5].value);
			if (!(numInitialCount >= 0)){
				alert("Invalid initial count!");
				return;
			}
			var outData = new Array();
			outData.push({"SKU":tableInputs[0].value, "PRODUCT_NAME":tableInputs[1].value, "LOCATION":tableInputs[2].value, "BIN_QTY":numBinQty, "PAR_LEVEL":numParLevel, "IN_RAPIDFILL":numInitialCount});
			submitAddProductToSheet(outData);
		}
		catch (e){}
		break;
	case 9://Receiving Refills
		var outData = new Array();
		for (var i = 0; i < tableInputs.length / 5; i++){
			try{
				var num = parseInt(tableInputs[i*5].value);
				if (isNaN(num) || num < 0) num = 0;
				var numPartial = parseInt(tableInputs[i*5+1].value);
				if (isNaN(numPartial) || numPartial < 0 || num == 0) numPartial = 0;
				var requestBins = tableInputs[i*5+2].checked == true;
				var tookLastBin = tableInputs[i*5+3].checked == true;
				var oos = tableInputs[i*5+4].checked == true;
				if (tableInputs[i*5+2].checked != tableInputs[i*5+2].initialValue ||
					tableInputs[i*5+3].checked != tableInputs[i*5+3].initialValue ||
					tableInputs[i*5+4].checked != tableInputs[i*5+4].initialValue ||
					num > 0)
					outData.push({"ID":tableInputs[i*5].productID, "BIN_QTY":num, "PARTIAL_QTY":numPartial, "BINS_NEEDED_FROM_RECEIVING":requestBins, "TOOK_LAST_CASI_BIN":tookLastBin, "OOS_SHARE_WITH_CASI":oos});
			}
			catch (e){}
		}
		if (outData.length <= 0){
			alert("Nothing to submit!");
			return;
		}
		submitReceivingToSheet(outData);
		break;
	}
	setOverlay(true,"Loading... Please wait.",false);
}

function onBackButtonClick(){
	if (isWaitingOnNetwork) return;
	if (hasUnsavedChanges){
		if (!confirm("Leave the page? There may be unsaved changes.")) return;
	}
	loadPage(5);
}

function setTheme(themeName){
	localStorage.setItem('theme', themeName);
	document.documentElement.className = themeName;
}

function toggleTheme(){
	if (localStorage.getItem('theme') === 'theme-dark'){
		setTheme('theme-light');
	} else {
		setTheme('theme-dark');
	}
}

function onThemeButtonClick(){
	toggleTheme();
}

function loadTheme(){
	if (localStorage.getItem('theme') === 'theme-dark') {
		setTheme('theme-dark');
	} else {
		setTheme('theme-light');
	}
}

function onHomeButtonClick(){
	if (isWaitingOnNetwork) return;
	if (hasUnsavedChanges){
		if (!confirm("Leave the page? There may be unsaved changes.")) return;
	}
	loadPage(0);
}

function onSetZeroButtonClick(){
	if (isWaitingOnNetwork) return;
	for (var i = 0; i < tableInputs.length; i++){
		tableInputs[i].value = 0;
	}
}

function onSetBinButtonClick(){
	if (isWaitingOnNetwork) return;
	for (var i = 0; i < tableInputs.length; i++){
		tableInputs[i].value = tableInputs[i].binsNeeded;
	}
}

function onButtonRemoveProductClick(productID){
	if (isWaitingOnNetwork) return;
	if (confirm("Are you sure you want to remove this product? This cannot be undone.")){
		var outData = new Array();
		outData.push({"ID": productID});
		submitRemoveProductToSheet(outData);
		setOverlay(true,"Loading... Please wait.",false);
	}
}

function emptyTableExceptFirstRow(table){
	if (table.children.length > 1){
		var firstRow = table.firstChild;
		while (table.firstChild) {
			table.removeChild(table.lastChild);
		}
		table.appendChild(firstRow);
	}
}

function getRoundsArray(input){
	var arr = new Array();
	switch (typeof input){
	case 'number':
		arr.push(input);
		return arr;
	case 'string':
		strs = input.split(',');
		for (let i = 0; i < strs.length; i++){
			if (strs[i] != "") arr.push(parseInt(strs[i]));
			else arr.push(0);
		}
		return arr;
	}
}

function createElementWithTextNode(element, text, className){
	var elem = document.createElement(element);
	elem.appendChild(document.createTextNode(text));
	if (className != "") elem.className = className;
	return elem;
}

function createElementWithChildNode(element, child, className){
	var elem = document.createElement(element);
	elem.appendChild(child);
	if (className != "") elem.className = className;
	return elem;
}

function createTextField(defaultValue, className){
	var elem = document.createElement('input');
	elem.type = 'text';
	elem.initialValue = defaultValue;
	if (defaultValue != "") elem.value = defaultValue;
	if (className != "") elem.className = className;
	elem.addEventListener("keyup", onInputKeyUp);
	elem.addEventListener("change",onChange);
	return elem;
}

function createNumberField(min, max, step, defaultValue, className){
	var elem = document.createElement('input');
	elem.type = 'number';
	elem.min = min;
	elem.max = max;
	elem.step = step;
	elem.initialValue = defaultValue;
	if (typeof defaultValue === "number") elem.value = defaultValue;
	if (className != "") elem.className = className;
	elem.addEventListener("keyup", onInputKeyUp);
	elem.addEventListener("change",onChange);
	return elem;
}

function createCheckbox(value, checked, disabled, className){
	var elem = document.createElement('input');
	elem.type = 'checkbox';
	elem.value = value;
	if (checked) elem.checked = true;
	if (disabled) elem.disabled = true;
	if (className != "") elem.className = className;
	elem.initialValue = checked;
	elem.addEventListener("onchange",onChange);
	return elem;
}

function onChange(){
	hasUnsavedChanges = true;
}

function onInputKeyUp(){
	if (event.keyCode === 13) {// Number 13 is the "Enter" key on the keyboard
		// Cancel the default action
		event.preventDefault();
		
		focusNextInput(this);
	}
}

function focusNextInput(current){
    for (i = 0; i < tableInputs.length; i++){
        if (tableInputs[i].tab_index - current.tab_index == 1){
            tableInputs[i].focus();
            if (tableInputs[i].type == "text" || tableInputs[i].type == "number"){
                tableInputs[i].select();
            }
			return;
        }
    }
}

function buildPickTable(){
	var table = document.getElementById('tablePick').children[0];
	tableInputs = new Array();
	emptyTableExceptFirstRow(table);
	for (var i = 0; i < tableData.length; i++){
		var tableRow = document.createElement('tr');
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].SKU,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].PRODUCT_NAME,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].LOCATION,""));
		var input = createNumberField(0, 1000000, 1, "", "large");
		input.tab_index = i;
		tableInputs.push(input);
		tableRow.appendChild(createElementWithChildNode('td',input,""));
		table.appendChild(tableRow);
	}
}

function buildBinTable(){
	var table = document.getElementById('tableBin').children[0];
	tableInputs = new Array();
	emptyTableExceptFirstRow(table);
	var tab_index = 0;
	for (var i = 0; i < tableData.length; i++){
		if (tableData[i].BINS_NEEDED <= 0) continue;
		var tableRow = document.createElement('tr');
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].SKU,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].PRODUCT_NAME,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].LOCATION,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].IN_RAPIDFILL,""));
		var elem = createElementWithTextNode('td',tableData[i].PAR_LEVEL,"");
		elem.className = "noPrint";
		tableRow.appendChild(elem);
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].BIN_QTY,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].BINS_NEEDED,"large"));
		var input = createNumberField(0, 1000000, 1, "", "large");
		input.productID = tableData[i].ID;
		input.binsNeeded = tableData[i].BINS_NEEDED;
		input.tab_index = tab_index;
		tableInputs.push(input);
		tableRow.appendChild(createElementWithChildNode('td',input,""));
		var input = createNumberField(0, 1000000, 1, "", "large");
		input.productID = tableData[i].ID;
		input.binsNeeded = 0;
		input.tab_index = tab_index + 1000;
		tableInputs.push(input);
		tableRow.appendChild(createElementWithChildNode('td',input,""));
		tab_index++;
		var input = createCheckbox("requestBins", tableData[i].BINS_NEEDED_FROM_RECEIVING, false, "checkbox");
		input.productID = tableData[i].ID;
		input.tab_index = -1;
		tableInputs.push(input);
		tableRow.appendChild(createElementWithChildNode('td',input,""));
		var input = createCheckbox("tookLast", tableData[i].TOOK_LAST_CASI_BIN, false, "checkbox");
		input.productID = tableData[i].ID;
		input.tab_index = -1;
		tableInputs.push(input);
		tableRow.appendChild(createElementWithChildNode('td',input,""));
		tableRow.appendChild(createElementWithChildNode('td',createCheckbox("oos", tableData[i].OOS_SHARE_WITH_CASI, true, "checkbox"),""));
		table.appendChild(tableRow);
		tab_index++;
	}
}

function buildReceivingTable(){
	var table = document.getElementById('tableReceiving').children[0];
	tableInputs = new Array();
	emptyTableExceptFirstRow(table);
	var tab_index = 0;
	for (var i = 0; i < tableData.length; i++){
		if (!tableData[i].BINS_NEEDED_FROM_RECEIVING && !tableData[i].TOOK_LAST_CASI_BIN && !tableData[i].OOS_SHARE_WITH_CASI) continue;
		var tableRow = document.createElement('tr');
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].SKU,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].PRODUCT_NAME,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].LOCATION,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].IN_RAPIDFILL,""));
		var elem = createElementWithTextNode('td',tableData[i].PAR_LEVEL,"");
		elem.className = "noPrint";
		tableRow.appendChild(elem);
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].BIN_QTY,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].BINS_NEEDED,parseInt(tableData[i].BINS_NEEDED) > 0 ? "large" : ""));
		var input = createNumberField(0, 1000000, 1, "", "large");
		input.productID = tableData[i].ID;
		input.binsNeeded = tableData[i].BINS_NEEDED;
		input.tab_index = tab_index;
		tableInputs.push(input);
		tableRow.appendChild(createElementWithChildNode('td',input,""));
		var input = createNumberField(0, 1000000, 1, "", "large");
		input.productID = tableData[i].ID;
		input.binsNeeded = 0;
		input.tab_index = tab_index + 1000;
		tableInputs.push(input);
		tableRow.appendChild(createElementWithChildNode('td',input,""));
		var input = createCheckbox("requestBins", tableData[i].BINS_NEEDED_FROM_RECEIVING, false, "checkbox");
		input.productID = tableData[i].ID;
		input.tab_index = -1;
		tableInputs.push(input);
		tableRow.appendChild(createElementWithChildNode('td',input,""));
		var input = createCheckbox("tookLast", tableData[i].TOOK_LAST_CASI_BIN, false, "checkbox");
		input.productID = tableData[i].ID;
		input.tab_index = -1;
		tableInputs.push(input);
		tableRow.appendChild(createElementWithChildNode('td',input,""));
		var input = createCheckbox("oos", tableData[i].OOS_SHARE_WITH_CASI, false, "checkbox");
		input.productID = tableData[i].ID;
		input.tab_index = -1;
		tableInputs.push(input);
		tableRow.appendChild(createElementWithChildNode('td',input,""));
		table.appendChild(tableRow);
		tab_index++;
	}
}

function buildPreviousRoundTable(){
	var table = document.getElementById('tablePreviousRound').children[0];
	tableInputs = new Array();
	emptyTableExceptFirstRow(table);
	//Remove extra round columns
	while (table.children[0].children.length > 4){
		table.children[0].removeChild(table.children[0].lastChild);
	}
	var roundCount = getRoundsArray(tableData[0].PREVIOUS_ROUND).length;
	if (roundCount > 1){
		for (var i = 1; i < roundCount; i++){
			table.children[0].appendChild(createElementWithTextNode('th',"Round " + (i + 1),""));
		}
	}

	for (var i = 0; i < tableData.length; i++){
		var roundData = getRoundsArray(tableData[i].PREVIOUS_ROUND);
		var skip = true;
		for (var j = 0; j < roundData.length; j++){
			if (roundData[j] > 0){
				skip = false;
				break;
			}
		}
		if (skip) continue;

		var tableRow = document.createElement('tr');
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].SKU,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].PRODUCT_NAME,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].LOCATION,""));

		for (var j = 0; j < roundCount; j++){
			if (roundData.length > j) tableRow.appendChild(createElementWithTextNode('td',roundData[j],""));
			else tableRow.appendChild(createElementWithTextNode('td',"0",""));
		}

		table.appendChild(tableRow);
	}
}

function buildInventoryTable(){
	var table = document.getElementById('tableInventory').children[0];
	tableInputs = new Array();
	emptyTableExceptFirstRow(table);
	for (var i = 0; i < tableData.length; i++){
		var tableRow = document.createElement('tr');
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].SKU,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].PRODUCT_NAME,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].LOCATION,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].IN_RAPIDFILL,""));
		tableRow.appendChild(createElementWithChildNode('td',createCheckbox("requestBins", tableData[i].BINS_NEEDED_FROM_RECEIVING, true, "checkbox"),""));
		tableRow.appendChild(createElementWithChildNode('td',createCheckbox("tookLast", tableData[i].TOOK_LAST_CASI_BIN, true, "checkbox"),""));
		tableRow.appendChild(createElementWithChildNode('td',createCheckbox("oos", tableData[i].OOS_SHARE_WITH_CASI, true, "checkbox"),""));
		table.appendChild(tableRow);
	}
}

function buildCycleCountTable(){
	var table = document.getElementById('tableCycleCount').children[0];
	tableInputs = new Array();
	emptyTableExceptFirstRow(table);
	for (var i = 0; i < tableData.length; i++){
		var tableRow = document.createElement('tr');
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].SKU,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].PRODUCT_NAME,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].LOCATION,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].IN_RAPIDFILL,""));
		var input = createNumberField(0, 1000000, 1, "", "large");
		tableInputs.push(input);
		input.tab_index = i;
		tableRow.appendChild(createElementWithChildNode('td',input,""));
		var input = createCheckbox("requestBins", tableData[i].BINS_NEEDED_FROM_RECEIVING, false, "checkbox");
		input.productID = tableData[i].ID;
		input.tab_index = -1;
		tableInputs.push(input);
		tableRow.appendChild(createElementWithChildNode('td',input,""));
		var input = createCheckbox("tookLast", tableData[i].TOOK_LAST_CASI_BIN, false, "checkbox");
		input.productID = tableData[i].ID;
		input.tab_index = -1;
		tableInputs.push(input);
		tableRow.appendChild(createElementWithChildNode('td',input,""));
		tableRow.appendChild(createElementWithChildNode('td',createCheckbox("oos", tableData[i].OOS_SHARE_WITH_CASI, true, "checkbox"),""));
		table.appendChild(tableRow);
	}
}

function buildEditProductsTable(){
	var table = document.getElementById('tableEditProducts').children[0];
	tableInputs = new Array();
	emptyTableExceptFirstRow(table);
	for (var i = 0; i < tableData.length; i++){
		var tableRow = document.createElement('tr');
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].SKU,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].PRODUCT_NAME,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].LOCATION,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].BIN_QTY,""));
		tableRow.appendChild(createElementWithTextNode('td',tableData[i].PAR_LEVEL,""));
		var button = createElementWithTextNode('button',"Edit","");
		button.productID = tableData[i].ID;
		button.onclick = function(){
			editingProductID = this.productID;
			loadPage(6);
		};
		tableRow.appendChild(createElementWithChildNode('td',button,""));
		button = createElementWithTextNode('button',"Remove","");
		button.productID = tableData[i].ID;
		button.onclick = function(){
			onButtonRemoveProductClick(this.productID);
		};
		tableRow.appendChild(createElementWithChildNode('td',button,""));
		table.appendChild(tableRow);
	}
}

function buildEditSingleProductTable(){
	var table = document.getElementById('tableEditSingleProduct').children[0];
	tableInputs = new Array();
	emptyTableExceptFirstRow(table);
	var tableRow = document.createElement('tr');

	editingProductIndex = -1;
	for (var i = 0; i < tableData.length; i++){
		if (tableData[i].ID == editingProductID){
			editingProductIndex = i;
			break;
		}
	}
	if (editingProductIndex == -1){
		console.log("Error finding matching ID from available data - ID: " + editingProductID);
		loadPage(0);
		return;
	}

	var input = createTextField(tableData[editingProductIndex].SKU, "wide");
	tableInputs.push(input);
	tableRow.appendChild(createElementWithChildNode('td',input,""));

	var input = createTextField(tableData[editingProductIndex].PRODUCT_NAME, "wide");
	tableInputs.push(input);
	tableRow.appendChild(createElementWithChildNode('td',input,""));

	var input = createTextField(tableData[editingProductIndex].LOCATION, "wide");
	tableInputs.push(input);
	tableRow.appendChild(createElementWithChildNode('td',input,""));

	var input = createNumberField(1,1000000,1,tableData[editingProductIndex].BIN_QTY, "large");
	tableInputs.push(input);
	tableRow.appendChild(createElementWithChildNode('td',input,""));

	var input = createNumberField(0,1000000,1,tableData[editingProductIndex].PAR_LEVEL, "large");
	tableInputs.push(input);
	tableRow.appendChild(createElementWithChildNode('td',input,""));

	table.appendChild(tableRow);
}

function buildAddProductTable(){
	var table = document.getElementById('tableAddProduct').children[0];
	tableInputs = new Array();
	emptyTableExceptFirstRow(table);
	var tableRow = document.createElement('tr');

	var input = createTextField("", "wide");
	tableInputs.push(input);
	tableRow.appendChild(createElementWithChildNode('td',input,""));

	var input = createTextField("", "wide");
	tableInputs.push(input);
	tableRow.appendChild(createElementWithChildNode('td',input,""));

	var input = createTextField("", "wide");
	tableInputs.push(input);
	tableRow.appendChild(createElementWithChildNode('td',input,""));

	var input = createNumberField(1,1000000,1,50, "large");
	tableInputs.push(input);
	tableRow.appendChild(createElementWithChildNode('td',input,""));

	var input = createNumberField(0,1000000,1,50, "large");
	tableInputs.push(input);
	tableRow.appendChild(createElementWithChildNode('td',input,""));

	var input = createNumberField(0,1000000,1,0, "large");
	tableInputs.push(input);
	tableRow.appendChild(createElementWithChildNode('td',input,""));

	table.appendChild(tableRow);
}

//#region Network
function onLoadDataFromSheet(){
	isWaitingOnNetwork = false;
	try{
		var response = JSON.parse(this.responseText);
		if (response.result == 'success'){
			console.log('Request successful.');
			tableData = response.data;
			unloadCurrentPage();
			currentPage = 0;
			onDataLoaded();
			return;
		}
		else{
			console.log('Request unsuccessful.');
		}
	}
	catch (e){
		console.log('Request unsuccessful: ' + this.responseText);
	}
	setSubtitle(true, "Load failed. Retrying...", false);
	loadDataFromSheet();
}

function loadDataFromSheet(){
	webRequest(_googleSheetURL, JSON.stringify({"postType":"getData"}), onLoadDataFromSheet);
}

function onSubmitRoundToSheet(){
	isWaitingOnNetwork = false;
	try{
		var response = JSON.parse(this.responseText);
		if (response.result == 'success'){
			console.log('Request successful.');
			tableData = response.data;
			unloadCurrentPage();
			currentPage = 0;
			onDataLoaded();
			return;
		}
		else{
			console.log('Request unsuccessful.');
		}
	}
	catch (e){
		console.log('Request unsuccessful: ' + this.responseText);
	}
	setOverlay(true,"Submit failed. Please retry.", true);
}

function submitRoundToSheet(data){
	webRequest(_googleSheetURL, JSON.stringify({"postType":"submitRound", "data": data}), onSubmitRoundToSheet);
}

function onSubmitBinReplenishmentToSheet(){
	isWaitingOnNetwork = false;
	try{
		var response = JSON.parse(this.responseText);
		if (response.result == 'success'){
			console.log('Request successful.');
			tableData = response.data;
			unloadCurrentPage();
			currentPage = 0;
			onDataLoaded();
			return;
		}
		else{
			console.log('Request unsuccessful.');
		}
	}
	catch (e){
		console.log('Request unsuccessful: ' + this.responseText);
	}
	setOverlay(true,"Submit failed. Please retry.", true);
}

function submitBinReplenishmentToSheet(data){
	webRequest(_googleSheetURL, JSON.stringify({"postType":"submitBinReplenishment", "data": data}), onSubmitBinReplenishmentToSheet);
}

function onSubmitReceivingToSheet(){
	isWaitingOnNetwork = false;
	try{
		var response = JSON.parse(this.responseText);
		if (response.result == 'success'){
			console.log('Request successful.');
			tableData = response.data;
			unloadCurrentPage();
			currentPage = 0;
			onDataLoaded();
			return;
		}
		else{
			console.log('Request unsuccessful.');
		}
	}
	catch (e){
		console.log('Request unsuccessful: ' + this.responseText);
	}
	setOverlay(true,"Submit failed. Please retry.", true);
}

function submitReceivingToSheet(data){
	webRequest(_googleSheetURL, JSON.stringify({"postType":"submitReceiving", "data": data}), onSubmitReceivingToSheet);
}

function onSubmitCycleCountToSheet(){
	isWaitingOnNetwork = false;
	try{
		var response = JSON.parse(this.responseText);
		if (response.result == 'success'){
			console.log('Request successful.');
			tableData = response.data;
			unloadCurrentPage();
			currentPage = 0;
			onDataLoaded();
			return;
		}
		else{
			console.log('Request unsuccessful.');
		}
	}
	catch (e){
		console.log('Request unsuccessful: ' + this.responseText);
	}
	setOverlay(true,"Submit failed. Please retry.", true);
}

function submitCycleCountToSheet(data){
	webRequest(_googleSheetURL, JSON.stringify({"postType":"submitCycleCount", "data": data}), onSubmitCycleCountToSheet);
}

function onSubmitEditProductToSheet(){
	isWaitingOnNetwork = false;
	try{
		var response = JSON.parse(this.responseText);
		if (response.result == 'success'){
			console.log('Request successful.');
			tableData = response.data;
			unloadCurrentPage();
			currentPage = 5;
			onDataLoaded();
			return;
		}
		else{
			console.log('Request unsuccessful.');
		}
	}
	catch (e){
		console.log('Request unsuccessful: ' + this.responseText);
	}
	setOverlay(true,"Edit failed. Please retry.", true);
}

function submitEditProductToSheet(data){
	webRequest(_googleSheetURL, JSON.stringify({"postType":"editProduct", "data": data}), onSubmitEditProductToSheet);
}

function onSubmitAddProductToSheet(){
	isWaitingOnNetwork = false;
	try{
		var response = JSON.parse(this.responseText);
		if (response.result == 'success'){
			console.log('Request successful.');
			tableData = response.data;
			unloadCurrentPage();
			currentPage = 5;
			onDataLoaded();
			return;
		}
		else{
			console.log('Request unsuccessful.');
		}
	}
	catch (e){
		console.log('Request unsuccessful: ' + this.responseText);
	}
	setOverlay(true,"Submit failed. Please retry.", true);
}

function submitAddProductToSheet(data){
	webRequest(_googleSheetURL, JSON.stringify({"postType":"addProduct", "data": data}), onSubmitAddProductToSheet);
}

function onSubmitRemoveProductToSheet(){
	isWaitingOnNetwork = false;
	try{
		var response = JSON.parse(this.responseText);
		if (response.result == 'success'){
			console.log('Request successful.');
			tableData = response.data;
			unloadCurrentPage();
			currentPage = 5;
			onDataLoaded();
			return;
		}
		else{
			console.log('Request unsuccessful.');
		}
	}
	catch (e){
		console.log('Request unsuccessful: ' + this.responseText);
	}
	setOverlay(true,"Remove failed. Please retry.", true);
}

function submitRemoveProductToSheet(data){
	webRequest(_googleSheetURL, JSON.stringify({"postType":"removeProduct", "data": data}), onSubmitRemoveProductToSheet);
}

function onWebRequestError(){
	console.log("Webrequest Error!");
	webRequest(previousWebRequest.url, previousWebRequest.data, previousWebRequest.loadCallback);
}

function webRequest(url, data, loadCallback){
	console.log('Sending webrequest...');
	isWaitingOnNetwork = true;
	previousWebRequest.url = url;
	previousWebRequest.data = data;
	previousWebRequest.loadCallback = loadCallback;
	var xhr = new XMLHttpRequest();
	xhr.open("post", url, true);
	xhr.setRequestHeader('Content-Type', 'text/plain');
	xhr.onerror = onWebRequestError;
	xhr.onabort = onWebRequestError;
	xhr.ontimeout = onWebRequestError;
	xhr.onload = loadCallback;
	xhr.send(data);
}
//#endregion
</script>
<div class="mainContent">
	<h1 class="title">Rapidfill Inventory</h1>
	<h2 id="subTitle">Loading... Please wait a moment.</h2>
	<p id="refreshedLabel" class="noPrint"></p>
	<div id="divHeaderButtons" style="display: none;">
		<button onclick="onHomeButtonClick();">Back to Home</button>
		<button id="buttonAddProduct" onclick="loadPage(8);" style="display: none;">Add New Product</button>
		<button id="buttonSetZero" onclick="onSetZeroButtonClick();" style="display: none;">Set All 0s</button>
		<button id="buttonSetBins" onclick="onSetBinButtonClick();" style="display: none;">Set All Match-Bin</button>
	</div>
	<div id="divMainMenuButtons" style="display: none;">
		<button class="buttonMain" onclick="loadPage(1);" id="buttonMainRound" title="Enter data for a round and deduct from inventory.">Input Round</button>
		<br/>
		<button class="buttonMain" onclick="loadPage(2);" id="buttonMainBin" title="Pick depleted bins for rapidfill.">Bin Picking</button>
		<br/>
		<button class="buttonMain" onclick="loadPage(7);" id="buttonMainPreviousRound" title="View the quantities of today's rounds.">View Today's Rounds</button>
		<br/>
		<button class="buttonMain" onclick="loadPage(3);" title="View on-hand counts in Rapid-Fill.">View Inventory</button>
		<br/>
		<button class="buttonMain" onclick="loadPage(4);" title="Edit on-hand counts in Rapid-Fill.">Update Counts</button>
		<br/>
		<button class="buttonMain" onclick="loadPage(5);" title="Edit product details.">Edit Products</button>
		<br/>
		<button class="buttonMain" onclick="loadPage(9);" id="buttonMainReceiving" title="Receiving: Manage refills and bins in rapidfill and on the Casi line.">Receiving Refills</button>
	</div>
	<div id="divPickTable" class="divTable" style="display: none;">
		<table id="tablePick">
			<tr>
				<th>SKU</th>
				<th>Name</th>
				<th>Location</th>
				<th>Qty Picked</th>
			</tr>
		</table>
	</div>
	<div id="divBinTable" class="divTable" style="display: none;">
		<table id="tableBin">
			<tr>
				<th>SKU</th>
				<th>Name</th>
				<th>Location</th>
				<th>In Rapidfill</th>
				<th class="noPrint">Par Level</th>
				<th>Qty Per Bin</th>
				<th>Bins Needed</th>
				<th>Bins Picked<br/>(Including Partial)</th>
				<th class="thin">Partial Bin QTY</th>
				<th class="thin">Request bins from receiving?</th>
				<th class="thin">Took last bin from Casi?</th>
				<th class="thin">OOS - Share with Casi</th>
			</tr>
		</table>
	</div>
	<div id="divInventoryTable" class="divTable" style="display: none;">
		<table id="tableInventory">
			<tr>
				<th>SKU</th>
				<th>Name</th>
				<th>Location</th>
				<th>Qty</th>
				<th class="thin">Request bins from receiving?</th>
				<th class="thin">Took last bin from Casi?</th>
				<th class="thin">OOS - Share with Casi</th>
			</tr>
		</table>
	</div>
	<div id="divCycleCountTable" class="divTable" style="display: none;">
		<table id="tableCycleCount">
			<tr>
				<th>SKU</th>
				<th>Name</th>
				<th>Location</th>
				<th>Qty</th>
				<th>New Qty</th>
				<th class="thin">Request bins from receiving?</th>
				<th class="thin">Took last bin from Casi?</th>
				<th class="thin">OOS - Share with Casi</th>
			</tr>
		</table>
	</div>
	<div id="divEditProductsTable" class="divTable" style="display: none;">
		<table id="tableEditProducts">
			<tr>
				<th>SKU</th>
				<th>Name</th>
				<th>Location</th>
				<th>Qty Per Bin</th>
				<th>Par Level</th>
				<th>Edit</th>
				<th>Remove</th>
			</tr>
		</table>
	</div>
	<div id="divEditSingleProduct" style="display: none;">
		<table id="tableEditSingleProduct" style="overflow-y: visible;">
			<tr>
				<th>SKU</th>
				<th>Name</th>
				<th>Location</th>
				<th>Qty Per Bin</th>
				<th>Par Level</th>
			</tr>
		</table>
	</div>
	<div id="divAddProduct" style="display: none;">
		<table id="tableAddProduct" style="overflow-y: visible;">
			<tr>
				<th>SKU</th>
				<th>Name</th>
				<th>Location</th>
				<th>Qty Per Bin</th>
				<th>Par Level</th>
				<th>Initial QTY</th>
			</tr>
		</table>
	</div>
	<div id="divPreviousRound" class="divTable" style="display: none;">
		<table id="tablePreviousRound">
			<tr>
				<th>SKU</th>
				<th>Name</th>
				<th>Location</th>
				<th>Round 1</th>
			</tr>
		</table>
	</div>
	<div id="divReceivingTable" class="divTable" style="display: none;">
		<table id="tableReceiving">
			<tr>
				<th>SKU</th>
				<th>Name</th>
				<th>Location</th>
				<th>In Rapidfill</th>
				<th class="noPrint">Par Level</th>
				<th>Qty Per Bin</th>
				<th>Bins Needed</th>
				<th>Bins Picked<br/>(Including Partial)</th>
				<th class="thin">Partial Bin QTY</th>
				<th class="thin">Request bins from receiving?</th>
				<th class="thin">Took last bin from Casi?</th>
				<th class="thin">OOS - Share with Casi</th>
			</tr>
		</table>
	</div>
	<div id="divFooterButtons" style="display: none;">
		<button id="buttonCancel" style="display: none;" onclick="onBackButtonClick();">Cancel</button>
		<button id="buttonSubmit" onclick="onSubmitButtonClick();">Submit</button>
	</div>
	<div class="fixedBottomRight">
		<button onclick="onThemeButtonClick();">Switch Theme</button>
	</div>
	<div class="fixedBottomLeft" id="divBottomLeft">
		<p>Make sure adblockers are disabled for this site</p>
	</div>
</div>
<div id="divOverlay">
	<h1 class="overlayText" id="overlayText">Loading... Please wait.</h1>
	<br>
	<button class="overlayButton" id="buttonOverlay" onclick="setOverlay(false,null,false);">OK</button>
</div>
</body>
</html>